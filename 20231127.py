import arcpy
import datetime

my_month = ''
this_date = datetime.datetime.now()
if this_date.month < 10:
    my_month = "0" + str(this_date.month)
export_date = str(this_date.year) + str(this_date.month ) + str(this_date.day)
print(export_date)

arcpy.env.workspace = r'S:\src\TestProject\ZoningMaps.gdb'
arcpy.env.overwriteOutput = True

search_radius_range = ['0', '0.5 Miles', '1.0 Miles']
match_option_type = ['INTERSECT', 'CLOSEST']

arcpy.analysis.SpatialJoin(
    target_features="AddressPoints",
    join_features="EL",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_EL",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 10 Long 0 10,First,#,AddressPoints,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoints,Flag,0,10;ESiteID "ESiteID" true true false 10 Long 0 10,First,#,AddressPoints,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoints,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoints,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoints,Post_Code,0,5;ESN "ESN" true true false 10 Long 0 10,First,#,AddressPoints,ESN,-1,-1;Long "Long" true true false 19 Double 8 18,First,#,AddressPoints,Long,-1,-1;Lat "Lat" true true false 19 Double 8 18,First,#,AddressPoints,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoints,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoints,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoints,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoints,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoints,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoints,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoints,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoints,Add_Number,0,15;HouseInt "HouseInt" true true false 10 Long 0 10,First,#,AddressPoints,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoints,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoints,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoints,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoints,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoints,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoints,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoints,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoints,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoints,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoints,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoints,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoints,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoints,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoints,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoints,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoints,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,EL,SchoolName,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,EL,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('Elem Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_EL",
    join_features="MD",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_MD",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_EL,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_EL,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_EL,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_EL,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_EL,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_EL,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoint_SpatialJoin_EL,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_EL,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,MD,SchoolName,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,MD,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('Middle Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_MD",
    join_features="HS",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_HS",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MD,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MD,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MD,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_MD,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_MD,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MD,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoint_SpatialJoin_MD,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MD,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName" true true false 50 Text 0 0,First,#,HS,SchoolName,0,50;SchoolNumb_HS "SchoolNumb" true true false 4 Text 0 0,First,#,HS,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('High Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_HS",
    join_features="IB",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_IB",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_HS,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_HS,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_HS,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_HS,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_HS,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_HS,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoint_SpatialJoin_HS,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_HS,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName" true true false 50 Text 0 0,First,#,IB,SchoolName,0,50;SchoolNumb_IB "SchoolNumb" true true false 4 Text 0 0,First,#,IB,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('IB Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_IB",
    join_features="MAG",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_MAG",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_IB,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_IB,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_IB,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_IB,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_IB,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_IB,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoint_SpatialJoin_IB,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_IB,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName" true true false 254 Text 0 0,First,#,MAG,SchoolName,0,254;SchoolNumb_MAG "SchoolNumb" true true false 254 Text 0 0,First,#,MAG,SchoolNumb,0,254',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('Mag Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_MAG",
    join_features="CZ",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_CZ",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MAG,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MAG,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MAG,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_MAG,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_MAG,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_MAG,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,Inc_Muni,0,50;DateUpdate "DateUpdate" true true false 8 Date 0 0,First,#,AddressPoint_SpatialJoin_MAG,DateUpdate,-1,-1;SchoolName_EL "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolName_MAG,0,254;SchoolNumb_MAG "SchoolNumb" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_MAG,SchoolNumb_MAG,0,254;SchoolName_CZ "SchoolName" true true false 50 Text 0 0,First,#,CZ,SchoolName,0,50;SchoolNumb_CZ "SchoolNumb" true true false 4 Text 0 0,First,#,CZ,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('CZ Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_CZ",
    join_features="AICE",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_AICE",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_CZ,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_CZ,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_CZ,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_CZ,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_CZ,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_CZ,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,Inc_Muni,0,50;SchoolName_EL "SchoolName_EL" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb_EL" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName_HS" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb_HS" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName_IB" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb_IB" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_MAG,0,254;SchoolNumb_MAG "SchoolNumb_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_MAG,0,254;SchoolName_CZ "SchoolName_CZ" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolName_CZ,0,50;SchoolNumb_CZ "SchoolNumb_CZ" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_CZ,SchoolNumb_CZ,0,4;SchoolName_AICE "SchoolName_AICE" true true false 50 Text 0 0,First,#,AICE,SchoolName,0,50;SchoolNumb_AICE "SchoolNumb_AICE" true true false 4 Text 0 0,First,#,AICE,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('AICE Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_AICE",
    join_features="GLE",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_GLE",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_AICE,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_AICE,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_AICE,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_AICE,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_AICE,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_AICE,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,Inc_Muni,0,50;SchoolName_EL "SchoolName_EL" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb_EL" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName_HS" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb_HS" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName_IB" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb_IB" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_MAG,0,254;SchoolNumb_MAG "SchoolNumb_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_MAG,0,254;SchoolName_CZ "SchoolName_CZ" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_CZ,0,50;SchoolNumb_CZ "SchoolNumb_CZ" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_CZ,0,4;SchoolName_AICE "SchoolName_AICE" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolName_AICE,0,50;SchoolNumb_AICE "SchoolNumb_AICE" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_AICE,SchoolNumb_AICE,0,4;SchoolName_GLE "SchoolName" true true false 30 Text 0 0,First,#,GLE,SchoolName,0,30;SchoolNumb_GLE "SchoolNumb" true true false 4 Text 0 0,First,#,GLE,SchoolNumb,0,4',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('GLE Done')

arcpy.analysis.SpatialJoin(
    target_features="AddressPoint_SpatialJoin_GLE",
    join_features="LMH",
    out_feature_class=r"S:\src\TestProject\ZoningMaps.gdb\AddressPoint_SpatialJoin_LMH",
    join_operation="JOIN_ONE_TO_ONE",
    join_type="KEEP_ALL",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_GLE,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_GLE,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_GLE,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_GLE,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_GLE,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_GLE,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,Inc_Muni,0,50;SchoolName_EL "SchoolName_EL" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb_EL" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName_HS" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb_HS" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName_IB" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb_IB" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_MAG,0,254;SchoolNumb_MAG "SchoolNumb_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_MAG,0,254;SchoolName_CZ "SchoolName_CZ" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_CZ,0,50;SchoolNumb_CZ "SchoolNumb_CZ" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_CZ,0,4;SchoolName_AICE "SchoolName_AICE" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_AICE,0,50;SchoolNumb_AICE "SchoolNumb_AICE" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_AICE,0,4;SchoolName_GLE "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolName_GLE,0,30;SchoolNumb_GLE "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_GLE,SchoolNumb_GLE,0,4;PAR_RATE "PAR_RATE" true true false 1 Text 0 0,First,#,LMH,PAR_RATE,0,1;SYEAR "SYEAR" true true false 6 Text 0 0,First,#,LMH,SYEAR,0,6',
    match_option="CLOSEST",
    search_radius="0.5 Miles",
    distance_field_name=""
)

print('LMH Done')


arcpy.conversion.ExportTable(
    in_table="AddressPoint_SpatialJoin_LMH",
    out_table=r'S:\gis9000db.sde\dbo.TEMP_JOIN_LMH_' + export_date,
    where_clause="",
    use_field_alias_as_name="NOT_USE_ALIAS",
    field_mapping='OBJECTID "OBJECTID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_LMH,OBJECTID,-1,-1;Flag "Flag" true true false 10 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Flag,0,10;ESiteID "ESiteID" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_LMH,ESiteID,-1,-1;SiteType "SiteType" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SiteType,0,2;LR "LR" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,LR,0,1;Post_Code "Post_Code" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Post_Code,0,5;ESN "ESN" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_LMH,ESN,-1,-1;Long "Long" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_LMH,Long,-1,-1;Lat "Lat" true true false 8 Double 0 0,First,#,AddressPoint_SpatialJoin_LMH,Lat,-1,-1;ParcelNum "ParcelNum" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,ParcelNum,0,20;PD "PD" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,PD,0,5;PT "PT" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,PT,0,5;St_Name "St_Name" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,St_Name,0,50;St_PosTyp "St_PosTyp" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,St_PosTyp,0,5;St_PosDir "St_PosDir" true true false 5 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,St_PosDir,0,5;ZN "ZN" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,ZN,0,50;Add_Number "Add_Number" true true false 15 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Add_Number,0,15;HouseInt "HouseInt" true true false 4 Long 0 0,First,#,AddressPoint_SpatialJoin_LMH,HouseInt,-1,-1;PrimaryAdd "PrimaryAdd" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,PrimaryAdd,0,100;AddrLocati "AddrLocati" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,AddrLocati,0,2;PrimaryNam "PrimaryNam" true true false 100 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,PrimaryNam,0,100;Alias1 "Alias1" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Alias1,0,60;Alias2 "Alias2" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Alias2,0,60;Alias3 "Alias3" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Alias3,0,60;Alias4 "Alias4" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Alias4,0,60;Alias5 "Alias5" true true false 60 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Alias5,0,60;Unit "Unit" true true false 40 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Unit,0,40;County "County" true true false 154 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,County,0,154;MailingCit "MailingCit" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,MailingCit,0,254;T_MailingC "T_MailingC" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,T_MailingC,0,254;Country "Country" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Country,0,2;State "State" true true false 2 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,State,0,2;Inc_Muni "Inc_Muni" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,Inc_Muni,0,50;SchoolName_EL "SchoolName_EL" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_EL,0,30;SchoolNumb_EL "SchoolNumb_EL" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_EL,0,4;SchoolName_MD "SchoolName_MD" true true false 20 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_MD,0,20;SchoolNumb_MD "SchoolNumb_MD" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_MD,0,4;SchoolName_HS "SchoolName_HS" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_HS,0,50;SchoolNumb_HS "SchoolNumb_HS" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_HS,0,4;SchoolName_IB "SchoolName_IB" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_IB,0,50;SchoolNumb_IB "SchoolNumb_IB" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_IB,0,4;SchoolName_MAG "SchoolName_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_MAG,0,254;SchoolNumb_MAG "SchoolNumb_MAG" true true false 254 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_MAG,0,254;SchoolName_CZ "SchoolName_CZ" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_CZ,0,50;SchoolNumb_CZ "SchoolNumb_CZ" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_CZ,0,4;SchoolName_AICE "SchoolName_AICE" true true false 50 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_AICE,0,50;SchoolNumb_AICE "SchoolNumb_AICE" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_AICE,0,4;SchoolName_GLE "SchoolName" true true false 30 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolName_GLE,0,30;SchoolNumb_GLE "SchoolNumb" true true false 4 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SchoolNumb_GLE,0,4;PAR_RATE "PAR_RATE" true true false 1 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,PAR_RATE,0,1;SYEAR "SYEAR" true true false 6 Text 0 0,First,#,AddressPoint_SpatialJoin_LMH,SYEAR,0,6',
    sort_field=None
)


print('Exported Table as'+ export_date)


print('Zoning Process Complete')
